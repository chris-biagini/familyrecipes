// Cookbook generated by FamilyRecipes — do not edit directly.

#set page(
  paper: "us-letter",
  margin: (top: 1in, bottom: 1in, left: 1.25in, right: 1.25in),
)

#set text(font: "Libre Bodoni v2002", size: 11pt)

#show heading.where(level: 1): set text(font: "Jost*", size: 24pt)
#show heading.where(level: 2): set text(font: "Jost*", size: 18pt)
#show heading.where(level: 3): set text(font: "Jost*", size: 13pt)

#let page-ref(label) = context {
  let loc = query(label).first().location()
  link(loc)[#numbering("1", ..counter(page).at(loc))]
}

// ── Title Page ──

#page(numbering: none)[
  #align(center + horizon)[
    #text(font: "Jost*", size: 36pt, weight: "bold")[Our Recipes]
    #v(1em)
    #text(style: "italic", size: 14pt)[A collection of our family's favorite recipes.]
  ]
]

// ── Table of Contents ──

#page(numbering: none)[
  #outline(title: [Table of Contents], indent: 1.5em, depth: 2)
]

// ── Recipes ──

#set page(numbering: "1")
#counter(page).update(1)

<%- recipes_by_category.each do |category, recipes| -%>
#page[#align(center + horizon)[= <%= typst_escape.call(category) %>]]

<%- recipes.each do |recipe| -%>
== <%= typst_escape.call(recipe.title) %> <<%= recipe.id %>>
<%- if recipe.description -%>

_<%= typst_escape.call(recipe.description) %>_
<%- end -%>
<%- if recipe.yield_line -%>

_<%= typst_escape.call(recipe.yield_line) %>_
<%- end -%>
<%- recipe.steps.each do |step| -%>

=== <%= typst_escape.call(step.tldr) %>
<%- unless step.ingredient_list_items.empty? -%>

<%- step.ingredient_list_items.each do |item| -%>
<%- if item.is_a?(CrossReference) -%>
- #sym.arrow.r <%= typst_escape.call(item.target_title) %> (p.~#page-ref(<<%= item.target_slug %>>))<%= item.prep_note ? ": _#{typst_escape.call(item.prep_note)}_" : "" %>
<%- else -%>
- *<%= typst_escape.call(item.name) %>*<%= item.quantity ? ", #{typst_escape.call(item.quantity)}" : "" %><%= item.prep_note ? ": _#{typst_escape.call(item.prep_note)}_" : "" %>
<%- end -%>
<%- end -%>
<%- end -%>
<%- if step.instructions && !step.instructions.strip.empty? -%>

<%= typst_prose.call(step.instructions) %>
<%- end -%>
<%- end -%>
<%- if recipe.footer -%>

#line(length: 30%, stroke: 0.5pt)

<%= typst_prose.call(recipe.footer) %>
<%- end -%>

#pagebreak(weak: true)

<%- end -%>
<%- end -%>
// ── Quick Bites ──

#page[#align(center + horizon)[= Quick Bites]]

<%- quick_bites_by_category.each do |subcategory, bites| -%>
== <%= typst_escape.call(subcategory) %>

<%- bites.each do |bite| -%>
<%- if bite.ingredients.length <= 1 && bite.ingredients.first == bite.title -%>
- *<%= typst_escape.call(bite.title) %>*
<%- else -%>
- *<%= typst_escape.call(bite.title) %>*: <%= bite.ingredients.map { |i| typst_escape.call(i) }.join(', ') %>
<%- end -%>
<%- end -%>

<%- end -%>
// ── Ingredient Index ──

#page[#align(center + horizon)[= Ingredient Index]]

<%- ingredient_index.each do |name, recipes| -%>
*<%= typst_escape.call(name) %>* --- <%= recipes.map { |r| "#{typst_escape.call(r.title)} (p.~#page-ref(<#{r.id}>))" }.join(", ") %>

<%- end -%>
