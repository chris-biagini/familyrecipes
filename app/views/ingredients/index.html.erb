<% content_for(:title) { "#{current_kitchen.name}: Ingredients" } %>

<article class="ingredients-page" data-controller="ingredient-table">
  <header>
    <h1>Ingredients</h1>
  </header>

  <div class="ingredients-toolbar">
    <input type="search" class="ingredients-search"
           placeholder="Search ingredientsâ€¦"
           aria-label="Search ingredients"
           data-ingredient-table-target="searchInput"
           data-action="input->ingredient-table#search"
           autocomplete="off">
    <div id="ingredients-summary" class="filter-pills" role="group" aria-label="Filter ingredients">
      <%= render 'ingredients/summary_bar', summary: @summary %>
    </div>
  </div>

  <%= render 'ingredients/table', ingredient_rows: @ingredient_rows %>

  <% if current_kitchen.member?(current_user) %>
    <dialog class="nutrition-editor-dialog"
            data-controller="nutrition-editor"
            data-nutrition-editor-base-url-value="<%= nutrition_entry_upsert_path(ingredient_name: '__NAME__') %>"
            data-nutrition-editor-edit-url-value="<%= ingredient_edit_path(ingredient_name: '__NAME__') %>"
            data-nutrition-editor-target="dialog">
      <div class="editor-header">
        <h2 data-nutrition-editor-target="title">Edit Nutrition</h2>
        <button type="button" class="btn editor-close"
                data-action="click->nutrition-editor#close"
                aria-label="Close">&times;</button>
      </div>
      <div class="editor-errors" data-nutrition-editor-target="errors" hidden></div>
      <div class="editor-body">
        <turbo-frame id="nutrition-editor-form">
          <p class="loading-placeholder">Loading&hellip;</p>
        </turbo-frame>
      </div>
      <div class="editor-footer">
        <button type="button" class="btn editor-cancel"
                data-action="click->nutrition-editor#close">Cancel</button>
        <button type="button" class="btn btn-primary editor-save"
                data-nutrition-editor-target="saveButton"
                data-action="click->nutrition-editor#save">Save</button>
        <button type="button" class="btn btn-primary editor-save-next"
                data-nutrition-editor-target="saveNextButton"
                data-action="click->nutrition-editor#saveAndNext" hidden>
          Save &amp; Next<span data-nutrition-editor-target="nextLabel"></span>
        </button>
      </div>
    </dialog>
  <% end %>
</article>
