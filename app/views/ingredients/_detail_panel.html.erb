<%# locals: (ingredient_name:, entry:, recipes:) %>
<turbo-frame id="ingredient-detail-<%= ingredient_name.parameterize %>">
  <div class="ingredient-detail">
    <% if entry&.basis_grams %>
      <p class="detail-nutrition"><%= nutrition_summary(entry) %></p>
    <% else %>
      <p class="detail-nutrition detail-missing">No nutrition data</p>
    <% end %>

    <% dens = density_summary(entry) %>
    <% if dens %>
      <p class="detail-density"><%= dens %></p>
    <% else %>
      <p class="detail-density detail-missing">No density data</p>
    <% end %>

    <% portions = portions_summary(entry) %>
    <% if portions %>
      <p class="detail-portions"><%= safe_join(portions, ' Â· ') %></p>
    <% end %>

    <p class="detail-recipes">
      <% if recipes.any? %>
        <% recipes.each_with_index do |recipe, i| %>
          <% unless i.zero? %>, <% end %>
          <%= link_to recipe.title, recipe_path(recipe.slug) %>
        <% end %>
      <% else %>
        <span class="detail-missing">No recipes</span>
      <% end %>
    </p>

    <div class="detail-actions">
      <% if entry&.custom? %>
        <span class="source-badge source-custom">custom</span>
      <% elsif entry %>
        <span class="source-badge source-builtin">built-in</span>
      <% else %>
        <span class="source-badge source-missing">missing</span>
      <% end %>

      <button type="button" class="btn btn-small"
              data-ingredient-name="<%= ingredient_name %>">Edit</button>
      <% if entry&.custom? %>
        <button type="button" class="btn btn-small btn-secondary"
                data-ingredient-name="<%= ingredient_name %>">Reset to built-in</button>
      <% end %>
    </div>
  </div>
</turbo-frame>
